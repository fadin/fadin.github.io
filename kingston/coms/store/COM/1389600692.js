var method_name = "CorporateMeasures.comDataSetFindall";

var server_time = new Date(2018, 8-1, 13, 7, 39, 1);

var execution_time = 1.987643;


var ret = new Array();
ret = new Array();
ret[0] = new Object();
ret[0].ToString = "Operation Transactions()";
ret[0]._ToString = "Operation Transactions()";
ret[0].Active = true;
ret[0].Data = "";
ret[0].Date = new Date(2016, 5-1, 26, 8, 39, 45);
ret[0].Expires = new Date(0001, 1-1, 1, 0, 0, 0);
ret[0].Imported = new Date(0001, 1-1, 1, 0, 0, 0);
ret[0].Loading = false;
ret[0].Name = "Operation Transactions";
ret[0].NextRun = new Date(0001, 1-1, 1, 0, 0, 0);
ret[0].Order = 0;
ret[0].SqlQuery = "SELECT\r\n\tt1.Trd_HdrRecId, t1.Trd_Recid, CONVERT(datetime, CONVERT(varchar(10), t.Trh_DateTime, 101)) Trh_DateTime,\r\n\tt3.pcf_PatCaseNo,\r\n\tt3.pcf_PatType,\r\n\tCAST(t.Trh_BabyNo AS varchar) + \'-\' + t4.Bab_Name [Baby],\r\n\tt3.Pcf_PatStatus,\r\n\tt.Trh_BonNo,\r\n\tt2.Opx_Index + \'-\' + t2.Opx_Code + \'/\' + CAST(Trd_OprSub AS varchar) OprCode,\r\n\tt1.Trd_Range,\r\n\tt2.Opx_Desc,\r\n\tt2.Opx_MedAct,\r\n\tTrh_UsedRoom,\r\n\tTr.Opr_Desc,\r\n\tt3.pcf_FstName + \' \' + t3.pcf_FathName + \' \' + t3.pcf_FamName pcf_Name,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Code\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOK\')\r\n\tBOK_Code,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Name\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOK\')\r\n\tBOK,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Code\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOA\')\r\n\tBOA_Code,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Name\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOA\')\r\n\tBOA,\r\n\tTotalBOKLC,\r\n\tTotalBOKCC,\r\n\tTotalBOALC,\r\n\tTotalBOACC,\r\n\tTotalBONLC,\r\n\tTotalBONCC,\r\n\tTotalBOPLC,\r\n\tTotalBOPCC,\r\n\tt1.Trd_PaidByPatient,\r\n\tISNULL(TotalBOKLC, 0) + ISNULL(TotalBOALC, 0) + ISNULL(TotalBONLC, 0) + ISNULL(TotalBOPLC, 0) GenTotalLC,\r\n\tISNULL(TotalBOKCC, 0) + ISNULL(TotalBOACC, 0) + ISNULL(TotalBONCC, 0) + ISNULL(TotalBOPCC, 0) GenTotalCC,\r\n\tt1.Trd_Surplus,\r\n\tt3.pcf_RefDoc,\r\n\t(SELECT\r\n\t\t[Doc_Name]\r\n\tFROM tbl_main_doctors\r\n\tWHERE doc_code = t3.pcf_RefDoc)\r\n\t[RefDocName],\r\n\tTrh_TreatDoctor,\r\n\t(SELECT\r\n\t\t[Doc_Name]\r\n\tFROM tbl_main_doctors\r\n\tWHERE doc_code = Trh_TreatDoctor)\r\n\t[TrtDocName],\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId1)\r\n\tTrh_CovRecId1,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId1)\r\n\tCov1_Name,\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId2)\r\n\tTrh_CovRecId2,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId2)\r\n\tCov2_Name,\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId3)\r\n\tTrh_CovRecId3,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId3)\r\n\tCov3_Name,\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_PrivCovRecId)\r\n\tTrh_PrivCovRecId,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_PrivCovRecId)\r\n\tPrivCov_Name,\r\n\tCONVERT(datetime, CONVERT(varchar(10), Trd_CrDstmp, 101)) CreationDate,\r\n\tCONVERT(varchar(8), Trd_CrDstmp, 108) CreationTime,\r\n\tTrd_CrUstmp,\r\n\t(SELECT TOP 1\r\n\t\t[User_Name]\r\n\tFROM Com_UserInfo\r\n\tWHERE User_Code = Trd_CrUstmp)\r\n\tUserName,\r\n\tTrh_BOAType,\r\n\t(SELECT TOP 1\r\n\t\tMta_Description\r\n\tFROM tbl_Main_TypAnesthesia\r\n\tWHERE Mta_BOACode = Trh_BOAType)\r\n\tBOAdesc,\r\n\tOrd_CrUstmp,\r\n\tUser_Name\r\nFROM Hospital_A.dbo.tbl_Opr_TransHeader t\r\nINNER JOIN Hospital_A.dbo.tbl_Opr_TransDetails t1\r\n\tON t.Trh_RecId = t1.Trd_HdrRecId\r\nLEFT JOIN tbl_Opr_RequestDetails\r\n\tON trd_recid = Ord_InvOprRecid\r\nLEFT JOIN Com_UserInfo\r\n\tON Ord_CrUstmp = User_Code\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(Dtd_ActTotal1LC1, 0) + ISNULL(Dtd_ActTotal1LC2, 0) + ISNULL(Dtd_ActTotal1LC3, 0) + ISNULL(Dtd_PrivActTotalLC, 0)) TotalBOKLC,\r\n\tSUM(ISNULL(Dtd_ActTotal1CC1, 0) + ISNULL(Dtd_ActTotal1CC2, 0) + ISNULL(Dtd_ActTotal1CC3, 0) + ISNULL(Dtd_PrivActTotalCC, 0)) TotalBOKCC\r\nFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\nWHERE Dtd_Category = \'BOK\'\r\nGROUP BY Dtd_DetRecId) td\r\n\tON t1.Trd_Recid = td.Dtd_DetRecId\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(Dtd_ActTotal1LC1, 0) + ISNULL(Dtd_ActTotal1LC2, 0) + ISNULL(Dtd_ActTotal1LC3, 0) + ISNULL(Dtd_PrivActTotalLC, 0)) TotalBOALC,\r\n\tSUM(ISNULL(Dtd_ActTotal1CC1, 0) + ISNULL(Dtd_ActTotal1CC2, 0) + ISNULL(Dtd_ActTotal1CC3, 0) + ISNULL(Dtd_PrivActTotalCC, 0)) TotalBOACC\r\nFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\nWHERE Dtd_Category = \'BOA\'\r\nGROUP BY Dtd_DetRecId) td1\r\n\tON t1.Trd_Recid = td1.Dtd_DetRecId\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(Dtd_ActTotal1LC1, 0) + ISNULL(Dtd_ActTotal1LC2, 0) + ISNULL(Dtd_ActTotal1LC3, 0) + ISNULL(Dtd_PrivActTotalLC, 0)) TotalBONLC,\r\n\tSUM(ISNULL(Dtd_ActTotal1CC1, 0) + ISNULL(Dtd_ActTotal1CC2, 0) + ISNULL(Dtd_ActTotal1CC3, 0) + ISNULL(Dtd_PrivActTotalCC, 0)) TotalBONCC\r\nFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\nWHERE Dtd_Category = \'BON\'\r\nGROUP BY Dtd_DetRecId) td2\r\n\tON t1.Trd_Recid = td2.Dtd_DetRecId\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(Dtd_ActTotal1LC1, 0) + ISNULL(Dtd_ActTotal1LC2, 0) + ISNULL(Dtd_ActTotal1LC3, 0) + ISNULL(Dtd_PrivActTotalLC, 0)) TotalBOPLC,\r\n\tSUM(ISNULL(Dtd_ActTotal1CC1, 0) + ISNULL(Dtd_ActTotal1CC2, 0) + ISNULL(Dtd_ActTotal1CC3, 0) + ISNULL(Dtd_PrivActTotalCC, 0)) TotalBOPCC\r\nFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\nWHERE Dtd_Category = \'BOP\'\r\nGROUP BY Dtd_DetRecId) td3\r\n\tON t1.Trd_Recid = td3.Dtd_DetRecId\r\nINNER JOIN tbl_Main_OprExam t2\r\n\tON t1.Trd_OprRecId = t2.Opx_RecId\r\nINNER JOIN tbl_Adm_Patients t3\r\n\tON t.Trh_CaseRecId = t3.Pcf_RecId\r\nLEFT JOIN tbl_Adm_Babies t4\r\n\tON t.Trh_BabyNo = t4.Bab_BabyNo\r\n\tAND t.Trh_CaseRecId = t4.Bab_PatCaseRecId\r\nLEFT JOIN tbl_Main_Coverages t6\r\n\tON t.Trh_CovRecId1 = t6.Cov_RecId\r\nLEFT JOIN tbl_Main_Coverages t7\r\n\tON t.Trh_CovRecId2 = t7.Cov_RecId\r\nLEFT JOIN tbl_Main_Coverages t8\r\n\tON t.Trh_CovRecId3 = t8.Cov_RecId\r\nLEFT JOIN tbl_Main_Coverages t9\r\n\tON t.Trh_PrivCovRecId = t9.Cov_RecId\r\nLEFT JOIN tbl_Main_OprRooms tr\r\n\tON t.Trh_UsedRoom = tr.Opr_Code\r\nWHERE 1 = 1\r\nAND t3.Pcf_PatStatus = \'V\'\r\nAND CONVERT(datetime, CONVERT(varchar(10), t.Trh_DateTime, 101)) between CONVERT(date, getdate()-365) and CONVERT(date, getdate()-1)\r\nAND t3.Pcf_PatType IN (\'I\', \'E\')\r\nUNION ALL\r\nSELECT\r\n\tt1.Trd_HdrRecId, t1.Trd_Recid, CONVERT(datetime, CONVERT(varchar(10), t.Trh_DateTime, 101)) Trh_DateTime,\r\n\tt3.pcf_PatCaseNo,\r\n\tt3.pcf_PatType,\r\n\tCAST(t.Trh_BabyNo AS varchar) + \'-\' + t4.Bab_Name [Baby],\r\n\tt3.Pcf_PatStatus,\r\n\tt.Trh_BonNo,\r\n\tt2.Opx_Index + \'-\' + t2.Opx_Code + \'/\' + CAST(Trd_OprSub AS varchar) OprCode,\r\n\tt1.Trd_Range,\r\n\tt2.Opx_Desc,\r\n\tt2.Opx_MedAct,\r\n\tTrh_UsedRoom,\r\n\tTr.Opr_Desc,\r\n\tt3.pcf_FstName + \' \' + t3.pcf_FathName + \' \' + t3.pcf_FamName pcf_Name,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Code\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOK\')\r\n\tBOK_Code,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Name\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOK\')\r\n\tBOK,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Code\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOA\')\r\n\tBOA_Code,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Name\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOA\')\r\n\tBOA,\tTotalBOKLC,\r\n\tTotalBOKCC,\r\n\tTotalBOALC,\r\n\tTotalBOACC,\r\n\tTotalBONLC,\r\n\tTotalBONCC,\r\n\tTotalBOPLC,\r\n\tTotalBOPCC,\r\n\tt1.Trd_PaidByPatient,\r\n\tISNULL(TotalBOKLC, 0) + ISNULL(TotalBOALC, 0) + ISNULL(TotalBONLC, 0) + ISNULL(TotalBOPLC, 0) GenTotalLC,\r\n\tISNULL(TotalBOKCC, 0) + ISNULL(TotalBOACC, 0) + ISNULL(TotalBONCC, 0) + ISNULL(TotalBOPCC, 0) GenTotalCC,\r\n\tt1.Trd_Surplus,\r\n\tt3.pcf_RefDoc,\r\n\t(SELECT\r\n\t\t[Doc_Name]\r\n\tFROM tbl_main_doctors\r\n\tWHERE doc_code = t3.pcf_RefDoc)\r\n\t[RefDocName],\r\n\tTrh_TreatDoctor,\r\n\t(SELECT\r\n\t\t[Doc_Name]\r\n\tFROM tbl_main_doctors\r\n\tWHERE doc_code = Trh_TreatDoctor)\r\n\t[TrtDocName],\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId1)\r\n\tTrh_CovRecId1,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId1)\r\n\tCov1_Name,\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId2)\r\n\tTrh_CovRecId2,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId2)\r\n\tCov2_Name,\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId3)\r\n\tTrh_CovRecId3,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId3)\r\n\tCov3_Name,\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_PrivCovRecId)\r\n\tTrh_PrivCovRecId,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_PrivCovRecId)\r\n\tPrivCov_Name,\r\n\tCONVERT(datetime, CONVERT(varchar(10), Trd_CrDstmp, 101)) CreationDate,\r\n\tCONVERT(varchar(8), Trd_CrDstmp, 108) CreationTime,\r\n\tTrd_CrUstmp,\r\n\t(SELECT TOP 1\r\n\t\t[User_Name]\r\n\tFROM Com_UserInfo\r\n\tWHERE User_Code = Trd_CrUstmp)\r\n\tUserName,\r\n\tTrh_BOAType,\r\n\t(SELECT TOP 1\r\n\t\tMta_Description\r\n\tFROM tbl_Main_TypAnesthesia\r\n\tWHERE Mta_BOACode = Trh_BOAType)\r\n\tBOAdesc,\r\n\tOrd_CrUstmp,\r\n\tUser_Name\r\nFROM Hospital_H.dbo.tbl_Opr_TransHeader t\r\nINNER JOIN Hospital_H.dbo.tbl_Opr_TransDetails t1\r\n\tON t.Trh_RecId = t1.Trd_HdrRecId\r\nLEFT JOIN tbl_Opr_RequestDetails\r\n\tON trd_recid = Ord_InvOprRecid\r\nLEFT JOIN Com_UserInfo\r\n\tON Ord_CrUstmp = User_Code\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(Dtd_ActTotal1LC1, 0) + ISNULL(Dtd_ActTotal1LC2, 0) + ISNULL(Dtd_ActTotal1LC3, 0) + ISNULL(Dtd_PrivActTotalLC, 0)) TotalBOKLC,\r\n\tSUM(ISNULL(Dtd_ActTotal1CC1, 0) + ISNULL(Dtd_ActTotal1CC2, 0) + ISNULL(Dtd_ActTotal1CC3, 0) + ISNULL(Dtd_PrivActTotalCC, 0)) TotalBOKCC\r\nFROM Hospital_H.dbo.tbl_Opr_DrTransDetails\r\nWHERE Dtd_Category = \'BOK\'\r\nGROUP BY Dtd_DetRecId) td\r\n\tON t1.Trd_Recid = td.Dtd_DetRecId\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(Dtd_ActTotal1LC1, 0) + ISNULL(Dtd_ActTotal1LC2, 0) + ISNULL(Dtd_ActTotal1LC3, 0) + ISNULL(Dtd_PrivActTotalLC, 0)) TotalBOALC,\r\n\tSUM(ISNULL(Dtd_ActTotal1CC1, 0) + ISNULL(Dtd_ActTotal1CC2, 0) + ISNULL(Dtd_ActTotal1CC3, 0) + ISNULL(Dtd_PrivActTotalCC, 0)) TotalBOACC\r\nFROM Hospital_H.dbo.tbl_Opr_DrTransDetails\r\nWHERE Dtd_Category = \'BOA\'\r\nGROUP BY Dtd_DetRecId) td1\r\n\tON t1.Trd_Recid = td1.Dtd_DetRecId\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(Dtd_ActTotal1LC1, 0) + ISNULL(Dtd_ActTotal1LC2, 0) + ISNULL(Dtd_ActTotal1LC3, 0) + ISNULL(Dtd_PrivActTotalLC, 0)) TotalBONLC,\r\n\tSUM(ISNULL(Dtd_ActTotal1CC1, 0) + ISNULL(Dtd_ActTotal1CC2, 0) + ISNULL(Dtd_ActTotal1CC3, 0) + ISNULL(Dtd_PrivActTotalCC, 0)) TotalBONCC\r\nFROM Hospital_H.dbo.tbl_Opr_DrTransDetails\r\nWHERE Dtd_Category = \'BON\'\r\nGROUP BY Dtd_DetRecId) td2\r\n\tON t1.Trd_Recid = td2.Dtd_DetRecId\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(Dtd_ActTotal1LC1, 0) + ISNULL(Dtd_ActTotal1LC2, 0) + ISNULL(Dtd_ActTotal1LC3, 0) + ISNULL(Dtd_PrivActTotalLC, 0)) TotalBOPLC,\r\n\tSUM(ISNULL(Dtd_ActTotal1CC1, 0) + ISNULL(Dtd_ActTotal1CC2, 0) + ISNULL(Dtd_ActTotal1CC3, 0) + ISNULL(Dtd_PrivActTotalCC, 0)) TotalBOPCC\r\nFROM Hospital_H.dbo.tbl_Opr_DrTransDetails\r\nWHERE Dtd_Category = \'BOP\'\r\nGROUP BY Dtd_DetRecId) td3\r\n\tON t1.Trd_Recid = td3.Dtd_DetRecId\r\nINNER JOIN tbl_Main_OprExam t2\r\n\tON t1.Trd_OprRecId = t2.Opx_RecId\r\nINNER JOIN tbl_Adm_Patients t3\r\n\tON t.Trh_CaseRecId = t3.Pcf_RecId\r\nLEFT JOIN tbl_Adm_Babies t4\r\n\tON t.Trh_BabyNo = t4.Bab_BabyNo\r\n\tAND t.Trh_CaseRecId = t4.Bab_PatCaseRecId\r\nLEFT JOIN tbl_Main_Coverages t6\r\n\tON t.Trh_CovRecId1 = t6.Cov_RecId\r\nLEFT JOIN tbl_Main_Coverages t7\r\n\tON t.Trh_CovRecId2 = t7.Cov_RecId\r\nLEFT JOIN tbl_Main_Coverages t8\r\n\tON t.Trh_CovRecId3 = t8.Cov_RecId\r\nLEFT JOIN tbl_Main_Coverages t9\r\n\tON t.Trh_PrivCovRecId = t9.Cov_RecId\r\nLEFT JOIN tbl_Main_OprRooms tr\r\n\tON t.Trh_UsedRoom = tr.Opr_Code\r\nWHERE 1 = 1\r\nAND t3.Pcf_PatStatus = \'S\'\r\nAND t3.Pcf_PatAccSts = \'N\'\r\n-- AND CONVERT(datetime, CONVERT(varchar(10), t.Trh_DateTime, 101)) between CONVERT(date, getdate()-365) and CONVERT(date, getdate()-1)\r\nAND t3.Pcf_PatType IN (\'I\', \'E\')\r\nUNION ALL\r\nSELECT\r\n\tt1.Trd_HdrRecId, t1.Trd_Recid, CONVERT(datetime, CONVERT(varchar(10), t.Trh_DateTime, 101)) Trh_DateTime,\r\n\tt3.pcf_PatCaseNo,\r\n\tt3.pcf_PatType,\r\n\tCAST(t.Trh_BabyNo AS varchar) + \'-\' + t4.Bab_Name [Baby],\r\n\tt3.Pcf_PatStatus,\r\n\tt.Trh_BonNo,\r\n\tt2.Opx_Index + \'-\' + t2.Opx_Code + \'/\' + CAST(Trd_OprSub AS varchar) OprCode,\r\n\tt1.Trd_Range,\r\n\tt2.Opx_Desc,\r\n\tt2.Opx_MedAct,\r\n\tTrh_UsedRoom,\r\n\tTr.Opr_Desc,\r\n\tt3.pcf_FstName + \' \' + t3.pcf_FathName + \' \' + t3.pcf_FamName pcf_Name,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Code\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOK\')\r\n\tBOK_Code,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Name\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOK\')\r\n\tBOK,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Code\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOA\')\r\n\tBOA_Code,\r\n\t(SELECT TOP 1\r\n\t\tDoc_Name\r\n\tFROM Hospital_A.dbo.tbl_Opr_DrTransDetails\r\n\tINNER JOIN tbl_Main_Doctors\r\n\t\tON Dtd_Doccode = Doc_Code\r\n\tWHERE Dtd_DetrecId = t1.Trd_recid\r\n\tAND Dtd_Category = \'BOA\')\r\n\tBOA,\tTotalBOKLC,\r\n\tTotalBOKCC,\r\n\tTotalBOALC,\r\n\tTotalBOACC,\r\n\tTotalBONLC,\r\n\tTotalBONCC,\r\n\tTotalBOPLC,\r\n\tTotalBOPCC,\r\n\tt1.Trd_PaidByPatient,\r\n\tISNULL(TotalBOKLC, 0) + ISNULL(TotalBOALC, 0) + ISNULL(TotalBONLC, 0) + ISNULL(TotalBOPLC, 0) GenTotalLC,\r\n\tISNULL(TotalBOKCC, 0) + ISNULL(TotalBOACC, 0) + ISNULL(TotalBONCC, 0) + ISNULL(TotalBOPCC, 0) GenTotalCC,\r\n\tt1.Trd_Surplus,\r\n\tt3.pcf_RefDoc,\r\n\t(SELECT\r\n\t\t[Doc_Name]\r\n\tFROM tbl_main_doctors\r\n\tWHERE doc_code = t3.pcf_RefDoc)\r\n\t[RefDocName],\r\n\tTrh_TreatDoctor,\r\n\t(SELECT\r\n\t\t[Doc_Name]\r\n\tFROM tbl_main_doctors\r\n\tWHERE doc_code = Trh_TreatDoctor)\r\n\t[TrtDocName],\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId1)\r\n\tTrh_CovRecId1,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId1)\r\n\tCov1_Name,\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId2)\r\n\tTrh_CovRecId2,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId2)\r\n\tCov2_Name,\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId3)\r\n\tTrh_CovRecId3,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_CovRecId3)\r\n\tCov3_Name,\r\n\t(SELECT\r\n\t\tCov_Group + \'/\' + Cov_Code\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_PrivCovRecId)\r\n\tTrh_PrivCovRecId,\r\n\t(SELECT\r\n\t\tCov_Name\r\n\tFROM tbl_Main_Coverages\r\n\tWHERE Cov_RecId = Trh_PrivCovRecId)\r\n\tPrivCov_Name,\r\n\tCONVERT(datetime, CONVERT(varchar(10), Trd_CrDstmp, 101)) CreationDate,\r\n\tCONVERT(varchar(8), Trd_CrDstmp, 108) CreationTime,\r\n\tTrd_CrUstmp,\r\n\t(SELECT TOP 1\r\n\t\t[User_Name]\r\n\tFROM Com_UserInfo\r\n\tWHERE User_Code = Trd_CrUstmp)\r\n\tUserName,\r\n\tTrh_BOAType,\r\n\t(SELECT TOP 1\r\n\t\tMta_Description\r\n\tFROM tbl_Main_TypAnesthesia\r\n\tWHERE Mta_BOACode = Trh_BOAType)\r\n\tBOAdesc,\r\n\tOrd_CrUstmp,\r\n\tUser_Name\r\nFROM tbl_Opr_TransHeader t\r\nINNER JOIN tbl_Opr_TransDetails t1\r\n\tON t.Trh_RecId = t1.Trd_HdrRecId\r\nLEFT JOIN tbl_Opr_RequestDetails\r\n\tON trd_recid = Ord_InvOprRecid\r\nLEFT JOIN Com_UserInfo\r\n\tON Ord_CrUstmp = User_Code\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(CASE\r\n\t\tWHEN trh_CovRecid1 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov1\', \'LC\', \'BOK\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId2 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov2\', \'LC\', \'BOK\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId3 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov3\', \'LC\', \'BOK\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(dbo.GetTransAmounts(Trd_RecId, \'Priv\', \'LC\', \'BOK\', Dtd_DocCode, DEFAULT), 0)) TotalBOKLC,\r\n\tSUM(ISNULL(CASE\r\n\t\tWHEN trh_CovRecid1 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov1\', \'CC\', \'BOK\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId2 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov2\', \'CC\', \'BOK\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId3 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov3\', \'CC\', \'BOK\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(dbo.GetTransAmounts(Trd_RecId, \'Priv\', \'CC\', \'BOK\', Dtd_DocCode, DEFAULT), 0)) TotalBOKCC\r\nFROM Hospital.dbo.tbl_Opr_DrTransDetails\r\nINNER JOIN Hospital.dbo.tbl_Opr_TransDetails\r\n\tON Dtd_DetRecId = Trd_RecId\r\nINNER JOIN Hospital.dbo.tbl_Opr_TransHeader\r\n\tON Trd_HdrRecId = Trh_RecId\r\nWHERE Dtd_Category = \'BOK\'\r\nGROUP BY Dtd_DetRecId) td\r\n\tON t1.Trd_Recid = td.Dtd_DetRecId\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(CASE\r\n\t\tWHEN trh_CovRecid1 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov1\', \'LC\', \'BOA\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId2 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov2\', \'LC\', \'BOA\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId3 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov3\', \'LC\', \'BOA\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(dbo.GetTransAmounts(Trd_RecId, \'Priv\', \'LC\', \'BOA\', Dtd_DocCode, DEFAULT), 0)) TotalBOALC,\r\n\tSUM(ISNULL(CASE\r\n\t\tWHEN trh_CovRecid1 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov1\', \'CC\', \'BOA\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId2 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov2\', \'CC\', \'BOA\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId3 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov3\', \'CC\', \'BOA\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(dbo.GetTransAmounts(Trd_RecId, \'Priv\', \'CC\', \'BOA\', Dtd_DocCode, DEFAULT), 0)) TotalBOACC\r\nFROM Hospital.dbo.tbl_Opr_DrTransDetails\r\nINNER JOIN Hospital.dbo.tbl_Opr_TransDetails\r\n\tON Dtd_DetRecId = Trd_RecId\r\nINNER JOIN Hospital.dbo.tbl_Opr_TransHeader\r\n\tON Trd_HdrRecId = Trh_RecId\r\nWHERE Dtd_Category = \'BOA\'\r\nGROUP BY Dtd_DetRecId) td1\r\n\tON t1.Trd_Recid = td1.Dtd_DetRecId\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(CASE\r\n\t\tWHEN trh_CovRecid1 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov1\', \'LC\', \'BON\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId2 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov2\', \'LC\', \'BON\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId3 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov3\', \'LC\', \'BON\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(dbo.GetTransAmounts(Trd_RecId, \'Priv\', \'LC\', \'BON\', Dtd_DocCode, DEFAULT), 0)) TotalBONLC,\r\n\tSUM(ISNULL(CASE\r\n\t\tWHEN trh_CovRecid1 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov1\', \'CC\', \'BON\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId2 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov2\', \'CC\', \'BON\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId3 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov3\', \'CC\', \'BON\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(dbo.GetTransAmounts(Trd_RecId, \'Priv\', \'CC\', \'BON\', Dtd_DocCode, DEFAULT), 0)) TotalBONCC\r\nFROM Hospital.dbo.tbl_Opr_DrTransDetails\r\nINNER JOIN Hospital.dbo.tbl_Opr_TransDetails\r\n\tON Dtd_DetRecId = Trd_RecId\r\nINNER JOIN Hospital.dbo.tbl_Opr_TransHeader\r\n\tON Trd_HdrRecId = Trh_RecId\r\nWHERE Dtd_Category = \'BON\'\r\nGROUP BY Dtd_DetRecId) td2\r\n\tON t1.Trd_Recid = td2.Dtd_DetRecId\r\nLEFT JOIN (SELECT\r\n\tDtd_DetRecId,\r\n\tSUM(ISNULL(CASE\r\n\t\tWHEN trh_CovRecid1 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov1\', \'LC\', \'BOP\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId2 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov2\', \'LC\', \'BOP\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId3 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov3\', \'LC\', \'BOP\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(dbo.GetTransAmounts(Trd_RecId, \'Priv\', \'LC\', \'BOP\', Dtd_DocCode, DEFAULT), 0)) TotalBOPLC,\r\n\tSUM(ISNULL(CASE\r\n\t\tWHEN trh_CovRecid1 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov1\', \'CC\', \'BOP\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId2 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov2\', \'CC\', \'BOP\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(CASE\r\n\t\tWHEN trh_CovRecId3 IS NULL THEN NULL\r\n\t\tELSE dbo.GetTransAmounts(Trd_RecId, \'Cov3\', \'CC\', \'BOP\', Dtd_DocCode, DEFAULT)\r\n\tEND, 0) +\r\n\tISNULL(dbo.GetTransAmounts(Trd_RecId, \'Priv\', \'CC\', \'BOP\', Dtd_DocCode, DEFAULT), 0)) TotalBOPCC\r\nFROM Hospital.dbo.tbl_Opr_DrTransDetails\r\nINNER JOIN Hospital.dbo.tbl_Opr_TransDetails\r\n\tON Dtd_DetRecId = Trd_RecId\r\nINNER JOIN Hospital.dbo.tbl_Opr_TransHeader\r\n\tON Trd_HdrRecId = Trh_RecId\r\nWHERE Dtd_Category = \'BOP\'\r\nGROUP BY Dtd_DetRecId) td3\r\n\tON t1.Trd_Recid = td3.Dtd_DetRecId\r\nINNER JOIN tbl_Main_OprExam t2\r\n\tON t1.Trd_OprRecId = t2.Opx_RecId\r\nINNER JOIN tbl_Adm_Patients t3\r\n\tON t.Trh_CaseRecId = t3.Pcf_RecId\r\nLEFT JOIN tbl_Adm_Babies t4\r\n\tON t.Trh_BabyNo = t4.Bab_BabyNo\r\n\tAND t.Trh_CaseRecId = t4.Bab_PatCaseRecId\r\nLEFT JOIN tbl_Main_Coverages t6\r\n\tON t.Trh_CovRecId1 = t6.Cov_RecId\r\nLEFT JOIN tbl_Main_Coverages t7\r\n\tON t.Trh_CovRecId2 = t7.Cov_RecId\r\nLEFT JOIN tbl_Main_Coverages t8\r\n\tON t.Trh_CovRecId3 = t8.Cov_RecId\r\nLEFT JOIN tbl_Main_Coverages t9\r\n\tON t.Trh_PrivCovRecId = t9.Cov_RecId\r\nLEFT JOIN tbl_Main_OprRooms tr\r\n\tON t.Trh_UsedRoom = tr.Opr_Code\r\nWHERE 1 = 1\r\nAND (t3.Pcf_PatStatus = \'A\'\r\nOR (t3.Pcf_PatStatus = \'S\'\r\nAND Pcf_PatAccSts = \'Y\'))\r\n-- AND CONVERT(datetime, CONVERT(varchar(10), t.Trh_DateTime, 101)) between CONVERT(date, getdate()-365) and CONVERT(date, getdate()-1)\r\nAND t3.Pcf_PatType IN (\'I\', \'E\')";
ret[0].Type = "sql";
ret[0].Url = "";
ret[0].Id = 5;
ret[0].DataMapid = 18;
ret[0].DataMap = new Object();
ret[0].DataMap.ToString = "Operations Map";
ret[0].DataMap._ToString = "Operations Map";
ret[0].DataMap.Active = true;
ret[0].DataMap.Code = "OPREX";
ret[0].DataMap.Date = new Date(0001, 1-1, 1, 0, 0, 0);
ret[0].DataMap.DateFormat = "";
ret[0].DataMap.DateKey = "Trh_DateTime";
ret[0].DataMap.Enabled = true;
ret[0].DataMap.Name = "Operations Map";
ret[0].DataMap.Remark = "";
ret[0].DataMap.TimeFormat = "";
ret[0].DataMap.TimeKey = "";
ret[0].DataMap.Id = 18;
ret[0].DataMap.Organizationid = 1;
ret[0].DataMap.Organization = "";
ret[0].DataMap.DataSets = new Array();
ret[0].DataMap.DataMapValues = new Array();
ret[0].DataMap.DataFields = new Array();
ret[0].DataMap.Batches = new Array();
ret[0].Intervalid = 1;
ret[0].Interval = new Object();
ret[0].Interval.ToString = "Daily";
ret[0].Interval._ToString = "Daily";
ret[0].Interval.Active = true;
ret[0].Interval.Code = "1D";
ret[0].Interval.Date = new Date(2016, 6-1, 28, 1, 41, 0);
ret[0].Interval.Days = 1;
ret[0].Interval.Enabled = true;
ret[0].Interval.Format = "DD/M";
ret[0].Interval.Hours = 0;
ret[0].Interval.Minutes = 0;
ret[0].Interval.Months = 0;
ret[0].Interval.Name = "Daily";
ret[0].Interval.Order = 0;
ret[0].Interval.Remark = "";
ret[0].Interval.Seconds = 0;
ret[0].Interval.Years = 0;
ret[0].Interval.Id = 1;
ret[0].Interval.DataSets = new Array();
ret[0].DataSourceid = 1;
ret[0].DataSource = new Object();
ret[0].DataSource.ToString = "Hospital";
ret[0].DataSource._ToString = "Hospital";
ret[0].DataSource.Active = true;
ret[0].DataSource.Date = new Date(2015, 10-1, 4, 17, 55, 22);
ret[0].DataSource.DbName = "Hospital";
ret[0].DataSource.DbPwd = "arzsqlsa";
ret[0].DataSource.DbServer = "182.168.1.20";
ret[0].DataSource.DbType = "sqlserver";
ret[0].DataSource.DbUser = "sa";
ret[0].DataSource.Id = 1;
ret[0].DataSource.Organizationid = 1;
ret[0].DataSource.Organization = "";
ret[0].DataSource.DataSets = new Array();
ret[0].Performances = new Array();
ret[1] = new Object();
ret[1].ToString = "Employement History()";
ret[1]._ToString = "Employement History()";
ret[1].Active = true;
ret[1].Data = "";
ret[1].Date = new Date(2018, 3-1, 18, 19, 10, 1);
ret[1].Expires = new Date(0001, 1-1, 1, 0, 0, 0);
ret[1].Imported = new Date(0001, 1-1, 1, 0, 0, 0);
ret[1].Loading = false;
ret[1].Name = "Employement History";
ret[1].NextRun = new Date(0001, 1-1, 1, 0, 0, 0);
ret[1].Order = 0;
ret[1].SqlQuery = "select DATA.*, DATETIMEFROMPARTS(Year, Month, 1, 0, 0, 1, 0) Date from (\r\nselect Month, Year from (\r\nselect 1 \'Month\' union all\r\nselect 2 \'Month\' union all\r\nselect 3 \'Month\' union all\r\nselect 4 \'Month\' union all\r\nselect 5 \'Month\' union all\r\nselect 6 \'Month\' union all\r\nselect 7 \'Month\' union all\r\nselect 8 \'Month\' union all\r\nselect 9 \'Month\' union all\r\nselect 10 \'Month\' union all\r\nselect 11 \'Month\' union all\r\nselect 12 \'Month\') Months cross join (\r\nselect 2013 \'Year\' union all\r\nselect 2014 \'Year\' union all\r\nselect 2015 \'Year\' union all\r\nselect 2016 \'Year\' union all\r\nselect 2017 \'Year\' union all\r\nselect 2018 \'Year\' union all\r\nselect 2019 \'Year\' union all\r\nselect 2020 \'Year\'\r\n) Years\r\n) DateParts, (\r\nselect * from (\r\n\r\n-- sql should be added here with a StartDate and EndDate datetime columns\r\nselect Emp_Nbr, Emp_Status, App_Firstname + \' \' + App_family Emp_Name, Emp_StDate \'StartDate\', Emp_EdDate \'EndDate\',\r\nDep_Code, Dep_Desc, Job_TypeCode, Job_Desc\r\nfrom Accounting.dbo.PAY01_Employees\r\ninner join Accounting.dbo.Pay01_Application on App_RecId=Emp_AppRecId\r\ninner join Accounting.dbo.Pay01_Department on Emp_COpDep=Dep_RecId\r\ninner join Accounting.dbo.Pay01_Jobs on Job_recid=Emp_COpJob\r\n\r\n) _DATA\r\n) DATA\r\nwhere (StartDate is null or DATEFROMPARTS(Year(StartDate), Month(StartDate), 1)<=DATEFROMPARTS(Year, Month, 1))\r\nand (EndDate is null or DATEFROMPARTS(Year(EndDate), Month(EndDate), 1)>=DATEFROMPARTS(Year, Month, 1))\r\nand DATEFROMPARTS(Year, Month, 1)<DATEFROMPARTS(Year(getdate()), Month(getdate()), 1)";
ret[1].Type = "sql";
ret[1].Url = "";
ret[1].Id = 15;
ret[1].DataMapid = 14;
ret[1].DataMap = new Object();
ret[1].DataMap.ToString = "Status - Employees";
ret[1].DataMap._ToString = "Status - Employees";
ret[1].DataMap.Active = true;
ret[1].DataMap.Code = "MSR-EMPS";
ret[1].DataMap.Date = new Date(2018, 3-1, 18, 19, 11, 4);
ret[1].DataMap.DateFormat = "";
ret[1].DataMap.DateKey = "Date";
ret[1].DataMap.Enabled = true;
ret[1].DataMap.Name = "Status - Employees";
ret[1].DataMap.Remark = "";
ret[1].DataMap.TimeFormat = "";
ret[1].DataMap.TimeKey = "";
ret[1].DataMap.Id = 14;
ret[1].DataMap.Organizationid = 1;
ret[1].DataMap.Organization = "";
ret[1].DataMap.DataSets = new Array();
ret[1].DataMap.DataMapValues = new Array();
ret[1].DataMap.DataFields = new Array();
ret[1].DataMap.Batches = new Array();
ret[1].Intervalid = 0;
ret[1].DataSourceid = 1;
ret[1].DataSource = new Object();
ret[1].DataSource.ToString = "Hospital";
ret[1].DataSource._ToString = "Hospital";
ret[1].DataSource.Active = true;
ret[1].DataSource.Date = new Date(2015, 10-1, 4, 17, 55, 22);
ret[1].DataSource.DbName = "Hospital";
ret[1].DataSource.DbPwd = "arzsqlsa";
ret[1].DataSource.DbServer = "182.168.1.20";
ret[1].DataSource.DbType = "sqlserver";
ret[1].DataSource.DbUser = "sa";
ret[1].DataSource.Id = 1;
ret[1].DataSource.Organizationid = 1;
ret[1].DataSource.Organization = "";
ret[1].DataSource.DataSets = new Array();
ret[1].Performances = new Array();
ret[2] = new Object();
ret[2].ToString = "Admissions Status()";
ret[2]._ToString = "Admissions Status()";
ret[2].Active = true;
ret[2].Data = "";
ret[2].Date = new Date(2018, 3-1, 18, 19, 10, 1);
ret[2].Expires = new Date(0001, 1-1, 1, 0, 0, 0);
ret[2].Imported = new Date(0001, 1-1, 1, 0, 0, 0);
ret[2].Loading = false;
ret[2].Name = "Admissions Status";
ret[2].NextRun = new Date(0001, 1-1, 1, 0, 0, 0);
ret[2].Order = 0;
ret[2].SqlQuery = "select pcf_PatCaseNo, pcf_FstName + \' \' + pcf_FathName + \' \' + pcf_FamName pcf_Name, pcf_AdmBefore,\r\nTDOC.Doc_Code TrDocCode, TDOC.Doc_Name TrDocName, RDOC.Doc_Code RefDocCode, RDOC.Doc_Name RefDocName, pcf_PatType,\r\nCov_Group + \'/\' + Cov_Code \'Cov_Code\', Cov_Name, Dep_Code, Dep_Name,\r\nDATEDIFF(MINUTE, (pcf_AdmDate + pcf_admTime), (pcf_DisChgDate + pcf_DisChgTime)) TimeInHospital\r\n, pcf_AdmDate + pcf_admTime \'StartDate\', pcf_DisChgDate + pcf_DisChgTime \'EndDate\'\r\nfrom Hospital.dbo.tbl_Adm_Patients\r\nleft join Hospital.dbo.tbl_Main_Coverages on Cov_RecId=pcf_CovRecid1\r\nleft join Hospital.dbo.tbl_Main_Doctors TDOC on TDOC.Doc_Code=pcf_TreatDoc\r\nleft join Hospital.dbo.tbl_Main_Doctors RDOC on RDOC.Doc_Code=pcf_RefDoc\r\nleft join Hospital.dbo.tbl_Main_Departments on dep_Code=pcf_DepCode\r\nwhere pcf_AdmDate<DATEFROMPARTS(year(getdate()), month(getdate()), 1)";
ret[2].Type = "sql";
ret[2].Url = "";
ret[2].Id = 16;
ret[2].DataMapid = 15;
ret[2].DataMap = new Object();
ret[2].DataMap.ToString = "Status - Admissions";
ret[2].DataMap._ToString = "Status - Admissions";
ret[2].DataMap.Active = true;
ret[2].DataMap.Code = "MSR-ADMS";
ret[2].DataMap.Date = new Date(2018, 3-1, 18, 19, 11, 4);
ret[2].DataMap.DateFormat = "";
ret[2].DataMap.DateKey = "StartDate";
ret[2].DataMap.Enabled = true;
ret[2].DataMap.Name = "Status - Admissions";
ret[2].DataMap.Remark = "";
ret[2].DataMap.TimeFormat = "";
ret[2].DataMap.TimeKey = "";
ret[2].DataMap.Id = 15;
ret[2].DataMap.Organizationid = 1;
ret[2].DataMap.Organization = "";
ret[2].DataMap.DataSets = new Array();
ret[2].DataMap.DataMapValues = new Array();
ret[2].DataMap.DataFields = new Array();
ret[2].DataMap.Batches = new Array();
ret[2].Intervalid = 0;
ret[2].DataSourceid = 1;
ret[2].DataSource = new Object();
ret[2].DataSource.ToString = "Hospital";
ret[2].DataSource._ToString = "Hospital";
ret[2].DataSource.Active = true;
ret[2].DataSource.Date = new Date(2015, 10-1, 4, 17, 55, 22);
ret[2].DataSource.DbName = "Hospital";
ret[2].DataSource.DbPwd = "arzsqlsa";
ret[2].DataSource.DbServer = "182.168.1.20";
ret[2].DataSource.DbType = "sqlserver";
ret[2].DataSource.DbUser = "sa";
ret[2].DataSource.Id = 1;
ret[2].DataSource.Organizationid = 1;
ret[2].DataSource.Organization = "";
ret[2].DataSource.DataSets = new Array();
ret[2].Performances = new Array();
ret[3] = new Object();
ret[3].ToString = "Patient Stay()";
ret[3]._ToString = "Patient Stay()";
ret[3].Active = true;
ret[3].Data = "";
ret[3].Date = new Date(2018, 3-1, 18, 19, 10, 1);
ret[3].Expires = new Date(0001, 1-1, 1, 0, 0, 0);
ret[3].Imported = new Date(0001, 1-1, 1, 0, 0, 0);
ret[3].Loading = false;
ret[3].Name = "Patient Stay";
ret[3].NextRun = new Date(0001, 1-1, 1, 0, 0, 0);
ret[3].Order = 0;
ret[3].SqlQuery = "select\r\n-- top 100\r\npcf_PatCaseNo, pcf_FstName + \' \' + pcf_FathName + \' \' + pcf_FamName pcf_Name,\r\nRet_Type, Ret_Desc, Bep_BedNo, Bep_Floor + \'/\' + Bep_BedNo BedName, Flr_Code, Flr_Desc, Mes_Code, Mes_Name,\r\nDATEDIFF(MINUTE, Lrb_Date, ISNULL((\r\nselect top 1 LOS.Lrb_Date from Hospital.[dbo].[tbl_Adm_LogResBed] LOS where\r\nLOS.Lrb_PatCaseRecId=LRB.Lrb_PatCaseRecId\r\nand ISNULL(LOS.Lrb_BabyNo, 0)=ISNULL(LRB.Lrb_BabyNo, 0)\r\nand LOS.Lrb_Date>LRB.Lrb_Date\r\norder by LOS.Lrb_Date asc\r\n), (pcf_DisChgDate + pcf_DisChgTime))) TimeInBed, \r\nLrb_Date StartDate, ISNULL((\r\nselect top 1 LOS.Lrb_Date from Hospital.[dbo].[tbl_Adm_LogResBed] LOS where\r\nLOS.Lrb_PatCaseRecId=LRB.Lrb_PatCaseRecId\r\nand ISNULL(LOS.Lrb_BabyNo, 0)=ISNULL(LRB.Lrb_BabyNo, 0)\r\nand LOS.Lrb_Date>LRB.Lrb_Date\r\norder by LOS.Lrb_Date asc\r\n), (pcf_DisChgDate + pcf_DisChgTime)) EndDate\r\nfrom Hospital.[dbo].[tbl_Adm_LogResBed] LRB\r\ninner join Hospital.dbo.tbl_Adm_Patients on pcf_Recid=Lrb_PatCaseRecId\r\ninner join Hospital.dbo.tbl_Main_ResidenceType on Lrb_ResType=Ret_Type\r\ninner join Hospital.dbo.tbl_Main_BedsPlan on Bep_RecId=Lrb_BedRecId\r\ninner join Hospital.dbo.tbl_Main_MedServices on Mes_Code=Bep_MSCode\r\ninner join Hospital.dbo.tbl_Main_Floors on Flr_Code=Bep_Floor\r\nwhere pcf_PatStatus!=\'N\' and pcf_AdmDate<DATEFROMPARTS(year(getdate()), month(getdate()), 1)\r\n-- and year(pcf_AdmDate)=2018\r\norder by Lrb_PatCaseRecId asc, Lrb_Date asc";
ret[3].Type = "sql";
ret[3].Url = "";
ret[3].Id = 17;
ret[3].DataMapid = 16;
ret[3].DataMap = new Object();
ret[3].DataMap.ToString = "Status - Stay";
ret[3].DataMap._ToString = "Status - Stay";
ret[3].DataMap.Active = true;
ret[3].DataMap.Code = "MSR-STAYS";
ret[3].DataMap.Date = new Date(2018, 3-1, 18, 19, 11, 4);
ret[3].DataMap.DateFormat = "";
ret[3].DataMap.DateKey = "StartDate";
ret[3].DataMap.Enabled = true;
ret[3].DataMap.Name = "Status - Stay";
ret[3].DataMap.Remark = "";
ret[3].DataMap.TimeFormat = "";
ret[3].DataMap.TimeKey = "";
ret[3].DataMap.Id = 16;
ret[3].DataMap.Organizationid = 1;
ret[3].DataMap.Organization = "";
ret[3].DataMap.DataSets = new Array();
ret[3].DataMap.DataMapValues = new Array();
ret[3].DataMap.DataFields = new Array();
ret[3].DataMap.Batches = new Array();
ret[3].Intervalid = 0;
ret[3].DataSourceid = 1;
ret[3].DataSource = new Object();
ret[3].DataSource.ToString = "Hospital";
ret[3].DataSource._ToString = "Hospital";
ret[3].DataSource.Active = true;
ret[3].DataSource.Date = new Date(2015, 10-1, 4, 17, 55, 22);
ret[3].DataSource.DbName = "Hospital";
ret[3].DataSource.DbPwd = "arzsqlsa";
ret[3].DataSource.DbServer = "182.168.1.20";
ret[3].DataSource.DbType = "sqlserver";
ret[3].DataSource.DbUser = "sa";
ret[3].DataSource.Id = 1;
ret[3].DataSource.Organizationid = 1;
ret[3].DataSource.Organization = "";
ret[3].DataSource.DataSets = new Array();
ret[3].Performances = new Array();
ret[4] = new Object();
ret[4].ToString = "Consultations()";
ret[4]._ToString = "Consultations()";
ret[4].Active = true;
ret[4].Data = "";
ret[4].Date = new Date(0001, 1-1, 1, 0, 0, 0);
ret[4].Expires = new Date(0001, 1-1, 1, 0, 0, 0);
ret[4].Imported = new Date(0001, 1-1, 1, 0, 0, 0);
ret[4].Loading = false;
ret[4].Name = "Consultations";
ret[4].NextRun = new Date(0001, 1-1, 1, 0, 0, 0);
ret[4].Order = 0;
ret[4].SqlQuery = "select\r\npcf_PatCaseNo, pcf_FstName + \' \' + pcf_FathName + \' \' + pcf_FamName pcf_Name, Doc_Code, Doc_Name, Dfe_Code, Dfe_Desc, Mes_Code, Mes_Name, Trd_Qty, (Trh_DateTime + Trd_CnsTime) \'StartDate\'\r\n-- , *\r\nfrom [Hospital].[dbo].[tbl_Cns_TransDetails]\r\ninner join [Hospital].[dbo].[tbl_Cns_TransHeader] on Trh_RecId=Trd_HdrRecId\r\ninner join [Hospital].[dbo].[tbl_Main_DocFeesExam] on Trd_FeesRecId=Dfe_RecId and Dfe_Desc like \'%CONSULTATION%\'\r\ninner join Hospital.dbo.tbl_Main_Doctors on Doc_Code=Trd_DocCode\r\ninner join Hospital.dbo.tbl_Main_MedServices on Mes_Code=Trh_MedService\r\ninner join Hospital.dbo.tbl_Adm_Patients on pcf_RecId = Trh_CaseRecId\r\nwhere Trh_DateTime<DATEFROMPARTS(year(getdate()), month(getdate()), 1)\r\nUNION\r\nselect\r\npcf_PatCaseNo, pcf_FstName + \' \' + pcf_FathName + \' \' + pcf_FamName pcf_Name, Doc_Code, Doc_Name, Dfe_Code, Dfe_Desc, Mes_Code, Mes_Name, Trd_Qty, (Trh_DateTime + Trd_CnsTime) \'StartDate\'\r\n-- , *\r\nfrom [Hospital_H].[dbo].[tbl_Cns_TransDetails]\r\ninner join [Hospital_H].[dbo].[tbl_Cns_TransHeader] on Trh_RecId=Trd_HdrRecId\r\ninner join [Hospital].[dbo].[tbl_Main_DocFeesExam] on Trd_FeesRecId=Dfe_RecId and Dfe_Desc like \'%CONSULTATION%\'\r\ninner join Hospital.dbo.tbl_Main_Doctors on Doc_Code=Trd_DocCode\r\ninner join Hospital.dbo.tbl_Main_MedServices on Mes_Code=Trh_MedService\r\ninner join Hospital.dbo.tbl_Adm_Patients on pcf_RecId = Trh_CaseRecId\r\nwhere Trh_DateTime<DATEFROMPARTS(year(getdate()), month(getdate()), 1)";
ret[4].Type = "sql";
ret[4].Url = "";
ret[4].Id = 18;
ret[4].DataMapid = 17;
ret[4].DataMap = new Object();
ret[4].DataMap.ToString = "Consulations";
ret[4].DataMap._ToString = "Consulations";
ret[4].DataMap.Active = true;
ret[4].DataMap.Code = "CONS";
ret[4].DataMap.Date = new Date(2018, 5-1, 1, 13, 1, 20);
ret[4].DataMap.DateFormat = "";
ret[4].DataMap.DateKey = "StartDate";
ret[4].DataMap.Enabled = true;
ret[4].DataMap.Name = "Consulations";
ret[4].DataMap.Remark = "";
ret[4].DataMap.TimeFormat = "";
ret[4].DataMap.TimeKey = "";
ret[4].DataMap.Id = 17;
ret[4].DataMap.Organizationid = 1;
ret[4].DataMap.Organization = "";
ret[4].DataMap.DataSets = new Array();
ret[4].DataMap.DataMapValues = new Array();
ret[4].DataMap.DataFields = new Array();
ret[4].DataMap.Batches = new Array();
ret[4].Intervalid = 0;
ret[4].DataSourceid = 1;
ret[4].DataSource = new Object();
ret[4].DataSource.ToString = "Hospital";
ret[4].DataSource._ToString = "Hospital";
ret[4].DataSource.Active = true;
ret[4].DataSource.Date = new Date(2015, 10-1, 4, 17, 55, 22);
ret[4].DataSource.DbName = "Hospital";
ret[4].DataSource.DbPwd = "arzsqlsa";
ret[4].DataSource.DbServer = "182.168.1.20";
ret[4].DataSource.DbType = "sqlserver";
ret[4].DataSource.DbUser = "sa";
ret[4].DataSource.Id = 1;
ret[4].DataSource.Organizationid = 1;
ret[4].DataSource.Organization = "";
ret[4].DataSource.DataSets = new Array();
ret[4].Performances = new Array();
ret[5] = new Object();
ret[5].ToString = "Lab Transactions()";
ret[5]._ToString = "Lab Transactions()";
ret[5].Active = true;
ret[5].Data = "";
ret[5].Date = new Date(2015, 10-1, 4, 17, 56, 26);
ret[5].Expires = new Date(0001, 1-1, 1, 0, 0, 0);
ret[5].Imported = new Date(0001, 1-1, 1, 0, 0, 0);
ret[5].Loading = false;
ret[5].Name = "Lab Transactions";
ret[5].NextRun = new Date(0001, 1-1, 1, 0, 0, 0);
ret[5].Order = 0;
ret[5].SqlQuery = "SELECT\r\n\tt1.Trd_HdrRecId, t1.Trd_Recid, t2.Lex_Module,\r\n\tt10.Imc_Desc,\r\n\tCONVERT (\r\n\t\tDateTime,\r\n\t\tCONVERT (\r\n\t\t\tVARCHAR (10),\r\n\t\t\tt.Trh_DateTime,\r\n\t\t\t101\r\n\t\t)\r\n\t) Trh_DateTime,\r\n\tt3.pcf_PatCaseNo,\r\n\tt3.pcf_PatType,\r\n\tt3.pcf_FstName + \' \' + t3.pcf_FathName + \' \' + t3.pcf_FamName pcf_Name,\r\n\tpcf_sex,\r\n\tcast(t.Trh_BabyNo AS VARCHAR) + \'-\' + t4.Bab_Name [ Baby ], t3.Pcf_PatStatus,\r\n\tt.Trh_BonNo,\r\n\tt.Trh_ReqDoctor,\r\n\tq.doc_name AS [ DocNameQ ], t2.Lex_Exam,\r\n\tt2.Lex_Desc,\r\n\tt1.Trd_Qty,\r\n\tt3.pcf_RefDoc,\r\n\tf.doc_name AS [ DocNameF ], t1.Trd_PaidByPatient,\r\n\tCASE\r\nWHEN isnull(Trd_ActTotalLC, 0) + isnull(Trd_ActTotalLC1, 0) + isnull(Trd_ActTotalLC2, 0) + isnull(Trd_ActTotalLC3, 0) + isnull(Trd_PrivActTotalLC, 0) = 0 THEN\r\n\tNULL\r\nELSE\r\n\tisnull(Trd_ActTotalLC, 0) + isnull(Trd_ActTotalLC1, 0) + isnull(Trd_ActTotalLC2, 0) + isnull(Trd_ActTotalLC3, 0) + isnull(Trd_PrivActTotalLC, 0)\r\nEND [ GenTotalLC ], CASE\r\nWHEN isnull(Trd_ActTotalCC, 0) + isnull(Trd_ActTotalCC1, 0) + isnull(Trd_ActTotalCC2, 0) + isnull(Trd_ActTotalCC3, 0) + isnull(Trd_PrivActTotalCC, 0) = 0 THEN\r\n\tNULL\r\nELSE\r\n\tisnull(Trd_ActTotalCC, 0) + isnull(Trd_ActTotalCC1, 0) + isnull(Trd_ActTotalCC2, 0) + isnull(Trd_ActTotalCC3, 0) + isnull(Trd_PrivActTotalCC, 0)\r\nEND [ GenTotalCC ], COALESCE (\r\n\tt1.trd_labdocper,\r\n\tt1.trd_poolper\r\n) QPPer,\r\n COALESCE (\r\n\tt1.trd_labdocper,\r\n\tt1.trd_poolper\r\n) * (\r\n\tCASE\r\n\tWHEN isnull(Trd_ActTotalLC, 0) + isnull(Trd_ActTotalLC1, 0) + isnull(Trd_ActTotalLC2, 0) + isnull(Trd_ActTotalLC3, 0) + isnull(Trd_PrivActTotalLC, 0) = 0 THEN\r\n\t\tNULL\r\n\tELSE\r\n\t\tisnull(Trd_ActTotalLC, 0) + isnull(Trd_ActTotalLC1, 0) + isnull(Trd_ActTotalLC2, 0) + isnull(Trd_ActTotalLC3, 0) + isnull(Trd_PrivActTotalLC, 0)\r\n\tEND\r\n) / 100 QPTotalLC,\r\n COALESCE (\r\n\tt1.trd_labdocper,\r\n\tt1.trd_poolper\r\n) * (\r\n\tCASE\r\n\tWHEN isnull(Trd_ActTotalCC, 0) + isnull(Trd_ActTotalCC1, 0) + isnull(Trd_ActTotalCC2, 0) + isnull(Trd_ActTotalCC3, 0) + isnull(Trd_PrivActTotalCC, 0) = 0 THEN\r\n\t\tNULL\r\n\tELSE\r\n\t\tisnull(Trd_ActTotalCC, 0) + isnull(Trd_ActTotalCC1, 0) + isnull(Trd_ActTotalCC2, 0) + isnull(Trd_ActTotalCC3, 0) + isnull(Trd_PrivActTotalCC, 0)\r\n\tEND\r\n) / 100 QPTotalCC,\r\n COALESCE (t5.doc_name, t7.Pol_Name) QPDoc,\r\n t1.Trd_ReqDocPer,\r\n t1.Trd_ReqDocPer * (\r\n\tCASE\r\n\tWHEN isnull(Trd_ActTotalLC, 0) + isnull(Trd_ActTotalLC1, 0) + isnull(Trd_ActTotalLC2, 0) + isnull(Trd_ActTotalLC3, 0) + isnull(Trd_PrivActTotalLC, 0) = 0 THEN\r\n\t\tNULL\r\n\tELSE\r\n\t\tisnull(Trd_ActTotalLC, 0) + isnull(Trd_ActTotalLC1, 0) + isnull(Trd_ActTotalLC2, 0) + isnull(Trd_ActTotalLC3, 0) + isnull(Trd_PrivActTotalLC, 0)\r\n\tEND\r\n) / 100 ReqTotalLC,\r\n t1.Trd_ReqDocPer * (\r\n\tCASE\r\n\tWHEN isnull(Trd_ActTotalCC, 0) + isnull(Trd_ActTotalCC1, 0) + isnull(Trd_ActTotalCC2, 0) + isnull(Trd_ActTotalCC3, 0) + isnull(Trd_PrivActTotalCC, 0) = 0 THEN\r\n\t\tNULL\r\n\tELSE\r\n\t\tisnull(Trd_ActTotalCC, 0) + isnull(Trd_ActTotalCC1, 0) + isnull(Trd_ActTotalCC2, 0) + isnull(Trd_ActTotalCC3, 0) + isnull(Trd_PrivActTotalCC, 0)\r\n\tEND\r\n) / 100 ReqTotalCC,\r\n t6.Doc_Name ReqDoc,\r\n t1.Trd_Surplus,\r\n Trd_Dstmp,\r\n Trd_Ustmp,\r\n CASE\r\nWHEN Lex_SendExtLabo = \'Y\' THEN\r\n\t\'True\'\r\nELSE\r\n\t\'False\'\r\nEND SentToExtLabo,\r\n lrh_CruStmp [ ReqUsr ], CrUsr.user_name [ ReqUsrName ]\r\nFROM\r\n\tHospital_H.dbo.tbl_Lab_TransHeader t\r\nINNER JOIN Hospital_H.dbo.tbl_Lab_TransDetails t1 ON t.Trh_RecId = t1.Trd_HdrRecId\r\nLEFT JOIN Hospital_H.dbo.tbl_Lab_RequestDetails Td ON Td.lrd_invexamrecid = t1.trd_recid\r\nLEFT JOIN Hospital_H.dbo.tbl_Lab_RequestHeader Th ON Td.lrd_hdrrecid = Th.lrh_recid\r\nLEFT JOIN com_userinfo CrUsr ON Th.lrh_CruStmp = CrUsr.user_code\r\nINNER JOIN tbl_Main_LabExam t2 ON t1.Trd_LabExamRecId = t2.Lex_RecId\r\nINNER JOIN tbl_Main_InvoicingModules t10 ON t2.Lex_Module = t10.Imc_Module\r\nINNER JOIN tbl_Adm_Patients t3 ON t.Trh_CaseRecId = t3.Pcf_RecId\r\nLEFT JOIN tbl_Adm_Babies t4 ON t.Trh_BabyNo = t4.Bab_BabyNo\r\nAND t.Trh_CaseRecId = t4.Bab_PatCaseRecId\r\nLEFT JOIN tbl_main_doctors t5 ON t1.trd_labdoctor = t5.Doc_Code\r\nLEFT JOIN tbl_main_doctors t6 ON t.Trh_ReqDoctor = t6.Doc_Code\r\nLEFT JOIN tbl_main_doctorsPool t7 ON t1.trd_labpool = t7.Pol_Code\r\nLEFT JOIN tbl_Main_BedsPlan t12 ON t.Trh_BedRecId = t12.Bep_RecId\r\nLEFT JOIN tbl_main_doctors q ON Trh_ReqDoctor = q.doc_code\r\nLEFT JOIN tbl_main_doctors f ON pcf_RefDoc = f.doc_code\r\nLEFT JOIN com_userinfo Usr ON trd_crUstmp = Usr.user_code\r\nWHERE\r\n\t1 = 1\r\nAND t10.imc_Module IN (\'LAB\', \'LANU\', \'LAPA\')\r\nAND t3.Pcf_PatStatus = \'S\'\r\nAND t3.Pcf_PatAccSts = \'N\'\r\nAND CONVERT (date, Trh_DateTime) BETWEEN DATETIMEFROMPARTS(2018, 01, 01, 0, 0, 0, 0) AND DATETIMEFROMPARTS(2018, 12, 31, 23, 59, 59, 998)\r\nAND t3.Pcf_PatType IN (\'I\', \'E\')\r\nUNION ALL\r\n\tSELECT\r\n\t\tt1.Trd_HdrRecId, t1.Trd_Recid, t2.Lex_Module,\r\n\t\tt10.Imc_Desc,\r\n\t\tCONVERT (\r\n\t\t\tDateTime,\r\n\t\t\tCONVERT (\r\n\t\t\t\tVARCHAR (10),\r\n\t\t\t\tt.Trh_DateTime,\r\n\t\t\t\t101\r\n\t\t\t)\r\n\t\t) Trh_DateTime,\r\n\t\tt3.pcf_PatCaseNo,\r\n\t\tt3.pcf_PatType,\r\n\t\tt3.pcf_FstName + \' \' + t3.pcf_FathName + \' \' + t3.pcf_FamName pcf_Name,\r\n\t\tpcf_sex,\r\n\t\tcast(t.Trh_BabyNo AS VARCHAR) + \'-\' + t4.Bab_Name [ Baby ], t3.Pcf_PatStatus,\r\n\t\tt.Trh_BonNo,\r\n\t\tt.Trh_ReqDoctor,\r\n\t\tq.doc_name AS [ DocNameQ ], t2.Lex_Exam,\r\n\t\tt2.Lex_Desc,\r\n\t\tt1.Trd_Qty,\r\n\t\tt3.pcf_RefDoc,\r\n\t\tf.doc_name AS [ DocNameF ], t1.Trd_PaidByPatient,\r\n\t\tCASE\r\n\tWHEN (\r\n\t\tCASE\r\n\t\tWHEN t.Trh_CovRecId IS NULL THEN\r\n\t\t\t0\r\n\t\tELSE\r\n\t\t\tdbo.GetTransAmounts (\r\n\t\t\t\tTrd_RecId,\r\n\t\t\t\t\'PreCov\',\r\n\t\t\t\t\'LC\',\r\n\t\t\t\t\'LAB\',\r\n\t\t\t\tDEFAULT,\r\n\t\t\t\tDEFAULT\r\n\t\t\t)\r\n\t\tEND + CASE\r\n\t\tWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t\t\t0\r\n\t\tELSE\r\n\t\t\tdbo.GetTransAmounts (\r\n\t\t\t\tTrd_RecId,\r\n\t\t\t\t\'Cov1\',\r\n\t\t\t\t\'LC\',\r\n\t\t\t\t\'LAB\',\r\n\t\t\t\tDEFAULT,\r\n\t\t\t\tDEFAULT\r\n\t\t\t)\r\n\t\tEND + CASE\r\n\t\tWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t\t\t0\r\n\t\tELSE\r\n\t\t\tdbo.GetTransAmounts (\r\n\t\t\t\tTrd_RecId,\r\n\t\t\t\t\'Cov2\',\r\n\t\t\t\t\'LC\',\r\n\t\t\t\t\'LAB\',\r\n\t\t\t\tDEFAULT,\r\n\t\t\t\tDEFAULT\r\n\t\t\t)\r\n\t\tEND + CASE\r\n\t\tWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t\t\t0\r\n\t\tELSE\r\n\t\t\tdbo.GetTransAmounts (\r\n\t\t\t\tTrd_RecId,\r\n\t\t\t\t\'Cov3\',\r\n\t\t\t\t\'LC\',\r\n\t\t\t\t\'LAB\',\r\n\t\t\t\tDEFAULT,\r\n\t\t\t\tDEFAULT\r\n\t\t\t)\r\n\t\tEND + dbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Priv\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\t) = 0 THEN\r\n\t\tNULL\r\n\tELSE\r\n\t\tCASE\r\n\tWHEN t.Trh_CovRecId IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'PreCov\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov1\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov2\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov3\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + dbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Priv\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\n\tEND [ GenTotalLC ], CASE\r\n\tWHEN (\r\n\t\tCASE\r\n\t\tWHEN t.Trh_CovRecId IS NULL THEN\r\n\t\t\t0\r\n\t\tELSE\r\n\t\t\tdbo.GetTransAmounts (\r\n\t\t\t\tTrd_RecId,\r\n\t\t\t\t\'PreCov\',\r\n\t\t\t\t\'CC\',\r\n\t\t\t\t\'LAB\',\r\n\t\t\t\tDEFAULT,\r\n\t\t\t\tDEFAULT\r\n\t\t\t)\r\n\t\tEND + CASE\r\n\t\tWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t\t\t0\r\n\t\tELSE\r\n\t\t\tdbo.GetTransAmounts (\r\n\t\t\t\tTrd_RecId,\r\n\t\t\t\t\'Cov1\',\r\n\t\t\t\t\'CC\',\r\n\t\t\t\t\'LAB\',\r\n\t\t\t\tDEFAULT,\r\n\t\t\t\tDEFAULT\r\n\t\t\t)\r\n\t\tEND + CASE\r\n\t\tWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t\t\t0\r\n\t\tELSE\r\n\t\t\tdbo.GetTransAmounts (\r\n\t\t\t\tTrd_RecId,\r\n\t\t\t\t\'Cov2\',\r\n\t\t\t\t\'CC\',\r\n\t\t\t\t\'LAB\',\r\n\t\t\t\tDEFAULT,\r\n\t\t\t\tDEFAULT\r\n\t\t\t)\r\n\t\tEND + CASE\r\n\t\tWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t\t\t0\r\n\t\tELSE\r\n\t\t\tdbo.GetTransAmounts (\r\n\t\t\t\tTrd_RecId,\r\n\t\t\t\t\'Cov3\',\r\n\t\t\t\t\'CC\',\r\n\t\t\t\t\'LAB\',\r\n\t\t\t\tDEFAULT,\r\n\t\t\t\tDEFAULT\r\n\t\t\t)\r\n\t\tEND + dbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Priv\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\t) = 0 THEN\r\n\t\tNULL\r\n\tELSE\r\n\t\tCASE\r\n\tWHEN t.Trh_CovRecId IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'PreCov\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov1\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov2\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov3\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + dbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Priv\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\n\tEND [ GenTotalCC ], COALESCE (\r\n\t\tt1.trd_labdocper,\r\n\t\tt1.trd_poolper\r\n\t) QPPer,\r\n\tCOALESCE (\r\n\t\tt1.trd_labdocper,\r\n\t\tt1.trd_poolper\r\n\t) * CASE\r\nWHEN (\r\n\tCASE\r\n\tWHEN t.Trh_CovRecId IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'PreCov\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov1\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov2\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov3\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + dbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Priv\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\n) = 0 THEN\r\n\tNULL\r\nELSE\r\n\tCASE\r\nWHEN t.Trh_CovRecId IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'PreCov\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov1\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov2\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov3\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + dbo.GetTransAmounts (\r\n\tTrd_RecId,\r\n\t\'Priv\',\r\n\t\'LC\',\r\n\t\'LAB\',\r\n\tDEFAULT,\r\n\tDEFAULT\r\n)\r\nEND / 100 QPTotalLC,\r\n COALESCE (\r\n\tt1.trd_labdocper,\r\n\tt1.trd_poolper\r\n) * CASE\r\nWHEN (\r\n\tCASE\r\n\tWHEN t.Trh_CovRecId IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'PreCov\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov1\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov2\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov3\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + dbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Priv\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\n) = 0 THEN\r\n\tNULL\r\nELSE\r\n\tCASE\r\nWHEN t.Trh_CovRecId IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'PreCov\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov1\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov2\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov3\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + dbo.GetTransAmounts (\r\n\tTrd_RecId,\r\n\t\'Priv\',\r\n\t\'CC\',\r\n\t\'LAB\',\r\n\tDEFAULT,\r\n\tDEFAULT\r\n)\r\nEND / 100 QPTotalCC,\r\n COALESCE (t5.doc_name, t7.Pol_Name) QPDoc,\r\n t1.Trd_ReqDocPer,\r\n t1.Trd_ReqDocPer * CASE\r\nWHEN (\r\n\tCASE\r\n\tWHEN t.Trh_CovRecId IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'PreCov\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov1\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov2\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov3\',\r\n\t\t\t\'LC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + dbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Priv\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\n) = 0 THEN\r\n\tNULL\r\nELSE\r\n\tCASE\r\nWHEN t.Trh_CovRecId IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'PreCov\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov1\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov2\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov3\',\r\n\t\t\'LC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + dbo.GetTransAmounts (\r\n\tTrd_RecId,\r\n\t\'Priv\',\r\n\t\'LC\',\r\n\t\'LAB\',\r\n\tDEFAULT,\r\n\tDEFAULT\r\n)\r\nEND / 100 ReqTotalLC,\r\n t1.Trd_ReqDocPer * CASE\r\nWHEN (\r\n\tCASE\r\n\tWHEN t.Trh_CovRecId IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'PreCov\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov1\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov2\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + CASE\r\n\tWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t\t0\r\n\tELSE\r\n\t\tdbo.GetTransAmounts (\r\n\t\t\tTrd_RecId,\r\n\t\t\t\'Cov3\',\r\n\t\t\t\'CC\',\r\n\t\t\t\'LAB\',\r\n\t\t\tDEFAULT,\r\n\t\t\tDEFAULT\r\n\t\t)\r\n\tEND + dbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Priv\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\n) = 0 THEN\r\n\tNULL\r\nELSE\r\n\tCASE\r\nWHEN t.Trh_CovRecId IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'PreCov\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId1 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov1\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId2 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov2\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + CASE\r\nWHEN t.Trh_CovRecId3 IS NULL THEN\r\n\t0\r\nELSE\r\n\tdbo.GetTransAmounts (\r\n\t\tTrd_RecId,\r\n\t\t\'Cov3\',\r\n\t\t\'CC\',\r\n\t\t\'LAB\',\r\n\t\tDEFAULT,\r\n\t\tDEFAULT\r\n\t)\r\nEND + dbo.GetTransAmounts (\r\n\tTrd_RecId,\r\n\t\'Priv\',\r\n\t\'CC\',\r\n\t\'LAB\',\r\n\tDEFAULT,\r\n\tDEFAULT\r\n)\r\nEND / 100 ReqTotalCC,\r\n t6.Doc_Name ReqDoc,\r\n t1.Trd_Surplus,\r\n Trd_Dstmp,\r\n Trd_Ustmp,\r\n CASE\r\nWHEN Lex_SendExtLabo = \'Y\' THEN\r\n\t\'True\'\r\nELSE\r\n\t\'False\'\r\nEND SentToExtLabo,\r\n lrh_CruStmp [ ReqUsr ], CrUsr.user_name [ ReqUsrName ]\r\nFROM\r\n\ttbl_Lab_TransHeader t\r\nINNER JOIN tbl_Lab_TransDetails t1 ON t.Trh_RecId = t1.Trd_HdrRecId\r\nLEFT JOIN tbl_Lab_RequestDetails Td ON Td.lrd_invexamrecid = t1.trd_recid\r\nLEFT JOIN tbl_Lab_RequestHeader Th ON Td.lrd_hdrrecid = Th.lrh_recid\r\nLEFT JOIN com_userinfo CrUsr ON Th.lrh_CruStmp = CrUsr.user_code\r\nINNER JOIN tbl_Main_LabExam t2 ON t1.Trd_LabExamRecId = t2.Lex_RecId\r\nINNER JOIN tbl_Main_InvoicingModules t10 ON t2.Lex_Module = t10.Imc_Module\r\nINNER JOIN tbl_Adm_Patients t3 ON t.Trh_CaseRecId = t3.Pcf_RecId\r\nLEFT JOIN tbl_Adm_Babies t4 ON t.Trh_BabyNo = t4.Bab_BabyNo\r\nAND t.Trh_CaseRecId = t4.Bab_PatCaseRecId\r\nLEFT JOIN tbl_main_doctors t5 ON t1.trd_labdoctor = t5.Doc_Code\r\nLEFT JOIN tbl_main_doctors t6 ON t.Trh_ReqDoctor = t6.Doc_Code\r\nLEFT JOIN tbl_main_doctorsPool t7 ON t1.trd_labpool = t7.Pol_Code\r\nLEFT JOIN tbl_Main_BedsPlan t12 ON t.Trh_BedRecId = t12.Bep_RecId\r\nLEFT JOIN tbl_main_doctors q ON Trh_ReqDoctor = q.doc_code\r\nLEFT JOIN tbl_main_doctors f ON pcf_RefDoc = f.doc_code\r\nLEFT JOIN com_userinfo Usr ON trd_crUstmp = Usr.user_code\r\nWHERE\r\n\t1 = 1\r\nAND t10.imc_Module IN (\'LAB\', \'LANU\', \'LAPA\')\r\nAND (\r\n\tt3.Pcf_PatStatus = \'A\'\r\n\tOR (\r\n\t\tt3.Pcf_PatStatus = \'S\'\r\n\t\tAND Pcf_PatAccSts = \'Y\'\r\n\t)\r\n)\r\nAND CONVERT (date, Trh_DateTime) BETWEEN DATETIMEFROMPARTS(2018, 01, 01, 0, 0, 0, 0) AND DATETIMEFROMPARTS(2018, 12, 31, 23, 59, 59, 998)\r\nAND t3.Pcf_PatType IN (\'I\', \'E\')";
ret[5].Type = "sql";
ret[5].Url = "";
ret[5].Id = 1;
ret[5].DataMapid = 1;
ret[5].DataMap = new Object();
ret[5].DataMap.ToString = "Lab Map";
ret[5].DataMap._ToString = "Lab Map";
ret[5].DataMap.Active = true;
ret[5].DataMap.Code = "LABEX";
ret[5].DataMap.Date = new Date(2015, 10-1, 4, 18, 2, 34);
ret[5].DataMap.DateFormat = "";
ret[5].DataMap.DateKey = "Trh_DateTime";
ret[5].DataMap.Enabled = true;
ret[5].DataMap.Name = "Lab Map";
ret[5].DataMap.Remark = "";
ret[5].DataMap.TimeFormat = "";
ret[5].DataMap.TimeKey = "";
ret[5].DataMap.Id = 1;
ret[5].DataMap.Organizationid = 1;
ret[5].DataMap.Organization = "";
ret[5].DataMap.DataSets = new Array();
ret[5].DataMap.DataMapValues = new Array();
ret[5].DataMap.DataFields = new Array();
ret[5].DataMap.Batches = new Array();
ret[5].Intervalid = 1;
ret[5].Interval = new Object();
ret[5].Interval.ToString = "Daily";
ret[5].Interval._ToString = "Daily";
ret[5].Interval.Active = true;
ret[5].Interval.Code = "1D";
ret[5].Interval.Date = new Date(2016, 6-1, 28, 1, 41, 0);
ret[5].Interval.Days = 1;
ret[5].Interval.Enabled = true;
ret[5].Interval.Format = "DD/M";
ret[5].Interval.Hours = 0;
ret[5].Interval.Minutes = 0;
ret[5].Interval.Months = 0;
ret[5].Interval.Name = "Daily";
ret[5].Interval.Order = 0;
ret[5].Interval.Remark = "";
ret[5].Interval.Seconds = 0;
ret[5].Interval.Years = 0;
ret[5].Interval.Id = 1;
ret[5].Interval.DataSets = new Array();
ret[5].DataSourceid = 1;
ret[5].DataSource = new Object();
ret[5].DataSource.ToString = "Hospital";
ret[5].DataSource._ToString = "Hospital";
ret[5].DataSource.Active = true;
ret[5].DataSource.Date = new Date(2015, 10-1, 4, 17, 55, 22);
ret[5].DataSource.DbName = "Hospital";
ret[5].DataSource.DbPwd = "arzsqlsa";
ret[5].DataSource.DbServer = "182.168.1.20";
ret[5].DataSource.DbType = "sqlserver";
ret[5].DataSource.DbUser = "sa";
ret[5].DataSource.Id = 1;
ret[5].DataSource.Organizationid = 1;
ret[5].DataSource.Organization = "";
ret[5].DataSource.DataSets = new Array();
ret[5].Performances = new Array();
ret[6] = new Object();
ret[6].ToString = "Doctors List()";
ret[6]._ToString = "Doctors List()";
ret[6].Active = true;
ret[6].Data = "";
ret[6].Date = new Date(2018, 3-1, 8, 17, 34, 17);
ret[6].Expires = new Date(2018, 3-1, 8, 17, 34, 17);
ret[6].Imported = new Date(2018, 3-1, 8, 17, 34, 17);
ret[6].Loading = false;
ret[6].Name = "Doctors List";
ret[6].NextRun = new Date(2018, 3-1, 8, 17, 34, 17);
ret[6].Order = 0;
ret[6].SqlQuery = "select DATA.*, DATETIMEFROMPARTS(Year, Month, 1, 0, 0, 1, 0) Date from (\r\nselect Month, Year from (\r\nselect 1 \'Month\' union all\r\nselect 2 \'Month\' union all\r\nselect 3 \'Month\' union all\r\nselect 4 \'Month\' union all\r\nselect 5 \'Month\' union all\r\nselect 6 \'Month\' union all\r\nselect 7 \'Month\' union all\r\nselect 8 \'Month\' union all\r\nselect 9 \'Month\' union all\r\nselect 10 \'Month\' union all\r\nselect 11 \'Month\' union all\r\nselect 12 \'Month\') Months cross join (\r\nselect 2013 \'Year\' union all\r\nselect 2014 \'Year\' union all\r\nselect 2015 \'Year\' union all\r\nselect 2016 \'Year\' union all\r\nselect 2017 \'Year\' union all\r\nselect 2018 \'Year\' union all\r\nselect 2019 \'Year\' union all\r\nselect 2020 \'Year\'\r\n) Years\r\n) DateParts, (\r\nselect * from (\r\n\r\n-- sql should be added here with a StartDate and EndDate datetime columns\r\nselect Doc_Code, Doc_Name, Dos_Code, Dos_Desc, Doc_Sex, min(pcf_AdmDate) \'StartDate\', max(pcf_AdmDate) \'EndDate\'\r\nfrom Hospital.dbo.tbl_Adm_Patients\r\ninner join Hospital.dbo.tbl_Main_Doctors on pcf_TreatDoc=Doc_Code and CHARINDEX(\'**\', Doc_Name)<=0\r\ninner join Hospital.dbo.tbl_Main_DoctorsSpeciality on Dos_Code=Doc_Speciality\r\ngroup by Doc_Code, Doc_Name, Dos_Code, Dos_Desc, Doc_Sex\r\n\r\n) _DATA\r\n) DATA\r\nwhere (StartDate is null or DATEFROMPARTS(Year(StartDate), Month(StartDate), 1)<=DATEFROMPARTS(Year, Month, 1))\r\nand (EndDate is null or DATEFROMPARTS(Year(EndDate), Month(EndDate), 1)>=DATEFROMPARTS(Year, Month, 1))\r\nand DATEFROMPARTS(Year, Month, 1)<DATEFROMPARTS(Year(getdate()), Month(getdate()), 1)";
ret[6].Type = "sql";
ret[6].Url = "";
ret[6].Id = 14;
ret[6].DataMapid = 13;
ret[6].DataMap = new Object();
ret[6].DataMap.ToString = "Status - Physicians";
ret[6].DataMap._ToString = "Status - Physicians";
ret[6].DataMap.Active = true;
ret[6].DataMap.Code = "MSR-PHYS";
ret[6].DataMap.Date = new Date(2018, 3-1, 8, 17, 25, 9);
ret[6].DataMap.DateFormat = "";
ret[6].DataMap.DateKey = "Date";
ret[6].DataMap.Enabled = true;
ret[6].DataMap.Name = "Status - Physicians";
ret[6].DataMap.Remark = "";
ret[6].DataMap.TimeFormat = "";
ret[6].DataMap.TimeKey = "";
ret[6].DataMap.Id = 13;
ret[6].DataMap.Organizationid = 1;
ret[6].DataMap.Organization = "";
ret[6].DataMap.DataSets = new Array();
ret[6].DataMap.DataMapValues = new Array();
ret[6].DataMap.DataFields = new Array();
ret[6].DataMap.Batches = new Array();
ret[6].Intervalid = 1;
ret[6].Interval = new Object();
ret[6].Interval.ToString = "Daily";
ret[6].Interval._ToString = "Daily";
ret[6].Interval.Active = true;
ret[6].Interval.Code = "1D";
ret[6].Interval.Date = new Date(2016, 6-1, 28, 1, 41, 0);
ret[6].Interval.Days = 1;
ret[6].Interval.Enabled = true;
ret[6].Interval.Format = "DD/M";
ret[6].Interval.Hours = 0;
ret[6].Interval.Minutes = 0;
ret[6].Interval.Months = 0;
ret[6].Interval.Name = "Daily";
ret[6].Interval.Order = 0;
ret[6].Interval.Remark = "";
ret[6].Interval.Seconds = 0;
ret[6].Interval.Years = 0;
ret[6].Interval.Id = 1;
ret[6].Interval.DataSets = new Array();
ret[6].DataSourceid = 1;
ret[6].DataSource = new Object();
ret[6].DataSource.ToString = "Hospital";
ret[6].DataSource._ToString = "Hospital";
ret[6].DataSource.Active = true;
ret[6].DataSource.Date = new Date(2015, 10-1, 4, 17, 55, 22);
ret[6].DataSource.DbName = "Hospital";
ret[6].DataSource.DbPwd = "arzsqlsa";
ret[6].DataSource.DbServer = "182.168.1.20";
ret[6].DataSource.DbType = "sqlserver";
ret[6].DataSource.DbUser = "sa";
ret[6].DataSource.Id = 1;
ret[6].DataSource.Organizationid = 1;
ret[6].DataSource.Organization = "";
ret[6].DataSource.DataSets = new Array();
ret[6].Performances = new Array();


ret.Count = 7;